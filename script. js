// عرض الوقت والتاريخ
function updateClock() {
  const now = new Date();
  const lang = document.documentElement.lang || 'ar';
  const options = {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  };
  const formatter = new Intl.DateTimeFormat(lang === 'ar' ? 'ar-TN' : 'fr-FR', options);
  document.getElementById('clock').textContent = formatter.format(now);
}
setInterval(updateClock, 1000);
updateClock();

// شريط الأخبار (RSS من BBC عربي)
async function fetchNews() {
  try {
    const response = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent("https://feeds.bbci.co.uk/arabic/rss.xml"));
    const data = await response.json();
    const parser = new DOMParser();
    const xml = parser.parseFromString(data.contents, "text/xml");
    const items = xml.querySelectorAll("item");
    const ticker = document.getElementById("news-ticker");
    let html = "";
    items.forEach((item, index) => {
      if (index < 5) {
        html += `📢 <a href="${item.querySelector("link").textContent}" target="_blank">${item.querySelector("title").textContent}</a> &nbsp;&nbsp;&nbsp;`;
      }
    });
    ticker.innerHTML = html;
  } catch (error) {
    document.getElementById("news-ticker").textContent = "⚠️ فشل في جلب الأخبار.";
  }
}
fetchNews();

// تبديل اللغة
document.getElementById("lang-switcher").addEventListener("click", () => {
  const html = document.documentElement;
  html.lang = html.lang === "ar" ? "fr" : "ar";
  updateClock();
  translateContent();
});

function translateContent() {
  const lang = document.documentElement.lang;
  const translations = {
    ar: {
      whatsapp: "راسلنا على واتساب",
      maps: "موقع الورشة على الخريطة",
      qr: "📱 امسح للوصول السريع",
      location: "مدنين – نخدمو في كامل أنحاء تونس",
      hours: "من الإثنين للسبت، 08:00 - 18:00 | الأحد راحة",
    },
    fr: {
      whatsapp: "Contactez-nous sur WhatsApp",
      maps: "Localisation de l'atelier",
      qr: "📱 Scannez pour un accès rapide",
      location: "Medenine – Service dans toute la Tunisie",
      hours: "Du lundi au samedi, 08:00 - 18:00 | Dimanche fermé",
    }
  };
  document.getElementById("whatsapp-btn").textContent = translations[lang].whatsapp;
  document.getElementById("maps-btn").textContent = translations[lang].maps;
  document.getElementById("qr-text").textContent = translations[lang].qr;
  document.getElementById("location-text").textContent = translations[lang].location;
  document.getElementById("hours-text").textContent = translations[lang].hours;
}
translateContent();

// الأسئلة الشائعة (FAQ toggle)
document.querySelectorAll(".faq-question").forEach((question) => {
  question.addEventListener("click", () => {
    const answer = question.nextElementSibling;
    answer.style.display = answer.style.display === "block" ? "none" : "block";
  });
});
