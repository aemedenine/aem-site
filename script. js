// â° Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø§Ø¹Ø© ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
function updateClock() {
  const now = new Date();
  const lang = document.documentElement.lang || 'ar';
  const options = {
    weekday: 'long', year: 'numeric', month: 'long',
    day: 'numeric', hour: '2-digit', minute: '2-digit'
  };
  const formatter = new Intl.DateTimeFormat(lang === 'ar' ? 'ar-TN' : 'fr-FR', options);
  document.getElementById('clock').textContent = formatter.format(now);
}
setInterval(updateClock, 1000);
updateClock();

// ğŸ“¢ Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ù…Ù† BBC Ø¹Ø±Ø¨ÙŠ
async function fetchNews() {
  try {
    const rssUrl = "https://feeds.bbci.co.uk/arabic/rss.xml";
    const response = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent(rssUrl));
    const data = await response.json();
    const parser = new DOMParser();
    const xml = parser.parseFromString(data.contents, "text/xml");
    const items = xml.querySelectorAll("item");
    const ticker = document.getElementById("news-ticker");
    ticker.innerHTML = "";
    items.forEach((item, i) => {
      if (i < 5) {
        const title = item.querySelector("title").textContent;
        const link = item.querySelector("link").textContent;
        ticker.innerHTML += `ğŸ“¢ <a href="${link}" target="_blank">${title}</a> &nbsp;&nbsp;&nbsp; `;
      }
    });
  } catch (error) {
    document.getElementById("news-ticker").textContent = "âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±.";
  }
}
fetchNews();

// ğŸŒ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© ÙˆØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ±
document.getElementById("lang-switcher").addEventListener("click", () => {
  const html = document.documentElement;
  html.lang = html.lang === "ar" ? "fr" : "ar";
  updateClock();
  translateStatic();
});

function translateStatic() {
  const lang = document.documentElement.lang;
  const tr = {
    ar: {
      whatsapp: "Ø±Ø§Ø³Ù„Ù†Ø§ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨",
      maps: "Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙˆØ±Ø´Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
      qr: "ğŸ“± Ø§Ù…Ø³Ø­ Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹",
      location: "Ù…Ø¯Ù†ÙŠÙ† â€“ Ù†Ø®Ø¯Ù…Ùˆ ÙÙŠ ÙƒØ§Ù…Ù„ Ø£Ù†Ø­Ø§Ø¡ ØªÙˆÙ†Ø³",
      hours: "Ù…Ù† Ø§Ù„Ø¥Ø«Ù†ÙŠÙ† Ù„Ù„Ø³Ø¨ØªØŒ 08:00 - 18:00 | Ø§Ù„Ø£Ø­Ø¯ Ø±Ø§Ø­Ø©"
    },
    fr: {
      whatsapp: "Contactez-nous sur WhatsApp",
      maps: "Localisation de l'atelier",
      qr: "ğŸ“± Scannez pour un accÃ¨s rapide",
      location: "Medenine â€“ Service dans toute la Tunisie",
      hours: "Du lundi au samedi, 08:00 - 18:00 | Dimanche fermÃ©"
    }
  };
  document.getElementById("whatsapp-btn").textContent = tr[lang].whatsapp;
  document.getElementById("maps-btn").textContent = tr[lang].maps;
  document.getElementById("qr-text").textContent = tr[lang].qr;
  document.getElementById("location-text").textContent = tr[lang].location;
  document.getElementById("hours-text").textContent = tr[lang].hours;
}
translateStatic();

// â“ ÙØªØ­/ØºÙ„Ù‚ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
document.querySelectorAll(".faq-question").forEach((q) => {
  q.addEventListener("click", () => {
    const a = q.nextElementSibling;
    a.style.display = (a.style.display === "block") ? "none" : "block";
  });
});

// ğŸ‘ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø­Ø³Ø¨ Ø¥Ø°Ø§ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ù„ÙƒØ§ÙˆÙ†ØªØ±)
if (localStorage.visitCount) {
  localStorage.visitCount = Number(localStorage.visitCount) + 1;
} else {
  localStorage.visitCount = 1;
}
const visitDisplay = document.getElementById("visit-count");
if (visitDisplay) visitDisplay.textContent = localStorage.visitCount;
