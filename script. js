document.addEventListener('DOMContentLoaded', () => {
  // الوقت
  function updateTime() {
    const now = new Date();
    const days = ['الأحد','الإثنين','الثلاثاء','الأربعاء','الخميس','الجمعة','السبت'];
    const months = ['جانفي','فيفري','مارس','أفريل','ماي','جوان','جويلية','أوت','سبتمبر','أكتوبر','نوفمبر','ديسمبر'];
    const day = days[now.getDay()];
    const date = now.getDate();
    const month = months[now.getMonth()];
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    document.getElementById('current-time').textContent = `${day} ${date} ${month} - ${hours}:${minutes}`;
  }

  // زيارات
  function updateVisits() {
    let visits = localStorage.getItem('visit-count');
    visits = visits ? parseInt(visits) + 1 : 1;
    localStorage.setItem('visit-count', visits);
    document.getElementById('visit-count').textContent = `عدد الزيارات: ${visits}`;
  }

  // أخبار حية
  function fetchNews() {
    const news = [
      "📢 ورشة إلكترونيك الرحماني تفتح أبوابها لجميع الولايات.",
      "🔧 خدمات تصليح الأجهزة الإلكترونية بجودة عالية وبأسعار منافسة.",
      "🌍 التوصيل عبر البريد متوفر لكل أنحاء تونس.",
      "📱 تواصل معنا عبر واتساب لأي استفسار."
    ];
    document.getElementById('live-news').textContent = news.join(' • ');
  }

  // FAQ
  document.querySelectorAll('.faq-item h3').forEach(h3 => {
    h3.addEventListener('click', () => {
      const parent = h3.parentElement;
      parent.classList.toggle('open');
    });
  });

  // الراديو
  const radio = document.getElementById('radio-stream');
  const radioBtn = document.getElementById('play-radio');
  radioBtn.addEventListener('click', () => {
    if (radio.paused) {
      radio.play();
      radioBtn.textContent = '⏸️ أوقف الراديو';
    } else {
      radio.pause();
      radioBtn.textContent = '📻 شغّل الراديو';
    }
  });

  // لايتبوكس
  window.openLightbox = function(src) {
    document.getElementById('lightbox-img').src = src;
    document.getElementById('lightbox').style.display = 'flex';
  }
  window.closeLightbox = function() {
    document.getElementById('lightbox').style.display = 'none';
  }

  // تعليق
  window.addComment = function(mediaId) {
    const textarea = document.getElementById(`comment-input-${mediaId}`);
    const commentText = textarea.value.trim();
    if (!commentText) return alert('اكتب تعليق أولاً');
    const commentDiv = document.createElement('div');
    commentDiv.className = 'comment';
    commentDiv.textContent = commentText;
    document.getElementById(`comments-${mediaId}`).appendChild(commentDiv);
    textarea.value = '';
  }

  // تفاعل
  window.addReaction = function(mediaId, reaction) {
    alert(`شكراً على تفاعلك ${reaction} لـ ${mediaId}`);
  }

  // تشغيل
  updateTime();
  updateVisits();
  fetchNews();
  setInterval(updateTime, 60000);
});
