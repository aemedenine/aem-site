// ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
function updateTime() {
  const now = new Date();
  const lang = localStorage.getItem("lang") || "ar";

  const days = {
    ar: ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'],
    fr: ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi']
  };

  const months = {
    ar: ['Ø¬Ø§Ù†ÙÙŠ', 'ÙÙŠÙØ±ÙŠ', 'Ù…Ø§Ø±Ø³', 'Ø£ÙØ±ÙŠÙ„', 'Ù…Ø§ÙŠ', 'Ø¬ÙˆØ§Ù†', 'Ø¬ÙˆÙŠÙ„ÙŠØ©', 'Ø£ÙˆØª', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'],
    fr: ['Janvier', 'FÃ©vrier', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'AoÃ»t', 'Septembre', 'Octobre', 'Novembre', 'DÃ©cembre']
  };

  const day = days[lang][now.getDay()];
  const date = now.getDate();
  const month = months[lang][now.getMonth()];
  const hours = now.getHours().toString().padStart(2, '0');
  const minutes = now.getMinutes().toString().padStart(2, '0');

  document.getElementById('current-time').textContent =
    lang === 'ar'
      ? `${day} ${date} ${month} - ${hours}:${minutes}`
      : `${day} ${date} ${month} - ${hours}h${minutes}`;
}

// Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª
function updateVisits() {
  let visits = localStorage.getItem('visit-count');
  visits = visits ? parseInt(visits) + 1 : 1;
  localStorage.setItem('visit-count', visits);
  const lang = localStorage.getItem("lang") || "ar";
  const text = lang === "ar" ? `Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª: ${visits}` : `Nombre de visites : ${visits}`;
  document.getElementById('visit-count').textContent = text;
}

// Ø£Ø®Ø¨Ø§Ø± BBC Ø¹Ø±Ø¨ÙŠØ©
fetch('https://api.rss2json.com/v1/api.json?rss_url=http://feeds.bbci.co.uk/arabic/rss.xml')
  .then(response => response.json())
  .then(data => {
    const newsItems = data.items.slice(0, 4);
    const newsText = newsItems.map(item => `ðŸ“° ${item.title}`).join(' âš¡ ');
    document.getElementById('live-news').textContent = newsText;
  })
  .catch(() => {
    document.getElementById('live-news').textContent = 'âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø®Ø¨Ø§Ø±.';
  });

// Ø²Ø± Ø§Ù„Ù„ØºØ©
function toggleLang() {
  const currentLang = localStorage.getItem("lang") || "ar";
  const newLang = currentLang === "ar" ? "fr" : "ar";
  localStorage.setItem("lang", newLang);
  applyLang();
  updateTime();
  updateVisits();
}

// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
function applyLang() {
  const lang = localStorage.getItem("lang") || "ar";
  document.documentElement.lang = lang;
  document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";

  const toggleBtn = document.querySelector(".lang-toggle");
  if (toggleBtn) toggleBtn.textContent = lang === "ar" ? "FranÃ§ais" : "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©";

  const title = document.getElementById("title");
  if (title) title.textContent = lang === "ar" ? "Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙˆØ±Ø´Ø©" : "Nos Services";

  document.querySelectorAll(".t").forEach(el => {
    const text = el.dataset[lang];
    if (text) el.textContent = text;
  });
}

// Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".faq-item h3").forEach(h3 => {
    h3.addEventListener("click", () => {
      const item = h3.parentElement;
      item.classList.toggle("open");
    });
  });

  applyLang();
  updateTime();
  updateVisits();
  setInterval(updateTime, 60000);
});

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
function playRadio() {
  const audio = document.getElementById("quran-radio");
  if (audio) audio.play();
}
