// script.js - وظائف الموقع

// عرض الوقت الحالي والشهر
function updateTime() {
  const now = new Date();
  const time = now.toLocaleTimeString('ar-TN');
  const month = now.toLocaleDateString('ar-TN', { month: 'long' });
  document.getElementById('current-time').textContent = `🕒 ${time} - ${month}`;
}
setInterval(updateTime, 1000);
updateTime();

// عداد الزيارات عبر localStorage
const visits = localStorage.getItem('visits') || 0;
localStorage.setItem('visits', parseInt(visits) + 1);
document.getElementById('visit-count').textContent = `عدد زياراتك: ${parseInt(visits) + 1}`;

// تشغيل وإيقاف الراديو
const radioBtn = document.getElementById('radio-btn');
const radio = document.getElementById('radio-stream');
let isPlaying = false;

if (radioBtn && radio) {
  radioBtn.addEventListener('click', () => {
    if (isPlaying) {
      radio.pause();
      radioBtn.textContent = 'شغّل الراديو';
    } else {
      radio.play();
      radioBtn.textContent = 'أوقف الراديو';
    }
    isPlaying = !isPlaying;
  });
}

// جلب الأخبار من BBC Arabic RSS
async function fetchNews() {
  try {
    const response = await fetch("https://api.rss2json.com/v1/api.json?rss_url=https://feeds.bbci.co.uk/arabic/rss.xml");
    const data = await response.json();
    const newsItems = data.items.slice(0, 5);
    const newsText = newsItems.map(item => `<a href='${item.link}' target='_blank'>${item.title}</a>`).join(" 🔸 ");
    document.getElementById("live-news").innerHTML = newsText;
  } catch (error) {
    document.getElementById("live-news").textContent = "تعذر تحميل الأخبار.";
  }
}
fetchNews();

// تغيير اللغة بين العربية والفرنسية
let isArabic = true;
const langBtn = document.getElementById('toggle-lang-btn');
langBtn.addEventListener('click', () => {
  isArabic = !isArabic;
  document.documentElement.lang = isArabic ? 'ar' : 'fr';
  document.documentElement.dir = isArabic ? 'rtl' : 'ltr';
  langBtn.textContent = isArabic ? 'تبديل اللغة' : 'Changer la langue';
  document.getElementById('visit-count').textContent = isArabic
    ? `عدد زياراتك: ${localStorage.getItem('visits')}`
    : `Nombre de visites : ${localStorage.getItem('visits')}`;
});

// الأسئلة الشائعة تفاعلية
const faqItems = document.querySelectorAll('.faq-item');
faqItems.forEach(item => {
  item.addEventListener('click', () => {
    faqItems.forEach(i => i.classList.remove('open'));
    item.classList.toggle('open');
  });
});
